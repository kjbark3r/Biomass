##########################################################
#### HERBACEOUS BIOMASS ESTIMATION - NSERP STUDY AREA ####
################## KJB  July 2016  #######################
##########################################################
#### NOTE: MUST USE 32 BIT R TO CONNECT TO ACCESS ####
## WD
wd_workcomp <- "C:\\Users\\kristin.barker\\Documents\\GitHub\\Biomass"
wd_laptop <- "C:\\Users\\kjbark3r\\Documents\\GitHub\\Biomass"
if (file.exists(wd_workcomp)) {
setwd(wd_workcomp)
} else {
if(file.exists(wd_laptop)) {
setwd(wd_laptop)
} else {
cat("Are you SURE you got that file path right?\n")
}
}
## PACKAGES
library(RODBC)
library(dplyr)
library(tidyr)
#########
## DATA - READ IN AND SET UP
#Connect to Access phenology database (work computer or laptop)
if (file.exists(wd_workcomp)) {
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};
dbq=C:/Users/kristin.barker/Documents/NSERP/Databases and Mort Reports/Sapphire_Veg_Database.accdb")
} else {
if(file.exists(wd_laptop)) {
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};
dbq=C:/Users/kjbark3r/Documents/NSERP/Databases/Sapphire_Veg_Database.accdb")
} else {
cat("Are you SURE you got that file path right?\n")
}
}
rm(wd_workcomp, wd_laptop)
# CLASSIFICATION - plus quadrat id, quadrat-visit ID, plot-visit ID, life form, genus
classn <- sqlQuery(channel, paste("select * from Classification"))
colnames(classn) <- c("VisitDate", "PlotID", "PlotM", "Species", "Total", "Live", "Senesced")
unique(classn$PlotID)
length(unique(classn$PlotID))
#Connect to Access phenology database (work computer or laptop)
if (file.exists(wd_workcomp)) {
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};
dbq=C:/Users/kristin.barker/Documents/NSERP/Databases and Mort Reports/Sapphire_Veg_Phenology.accdb")
} else {
if(file.exists(wd_laptop)) {
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};
dbq=C:/Users/kjbark3r/Documents/NSERP/Databases/Sapphire_Veg_Phenology.accdb")
} else {
cat("Are you SURE you got that file path right?\n")
}
}
rm(wd_workcomp, wd_laptop)
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};
dbq=C:/Users/kristin.barker/Documents/NSERP/Databases and Mort Reports/Sapphire_Veg_Phenology.accdb")
classn <- sqlQuery(channel, paste("select * from Classification"))
colnames(classn) <- c("VisitDate", "PlotID", "PlotM", "Species", "Total", "Live", "Senesced")
length(unique(classn$PlotID))
